<ng-title title="Your Cart" size="4xlarge" [border]="true" class="logo" />

<div class="border-neutral-300 border-solid border-[1px] rounded-2xl p-4 mt-4 h-[calc(100%-340px)] overflow-y-auto custom-scrollbar overflow-hidden">
  @for (item of cart()?.products; track item.id) {
    <div class="item flex justify-between">
      <div class="flex gap-4">
        <div class="w-[75px] h-[75px]">
          <img [src]="item.img" alt="" class="w-full h-full object-cover" />
        </div>
        <div class="flex flex-col justify-between">
          <h3>{{ item.name }}</h3>
          <p>{{ item.price | currency }}</p>
        </div>
      </div>
      <div class="flex items-end flex-col justify-between">
        <ng-icon name="ionTrash" size="20" class="text-red-500 cursor-pointer" (click)="onDeleteItem(item.id)" />

        <ng-counter [initial]="item.quantity" [min]="1" [max]="item.stock" (valueChange)="onCounterChange(item.id, $event)" />
      </div>
    </div>
  } @empty {
    <div class="flex justify-center items-center h-full">
      <p class="text-gray-400">No items in cart</p>
    </div>
  }
</div>

<div class="border-neutral-300 border-solid border-[1px] rounded-2xl p-4 mt-4">
  <ng-title title="Order Summary" size="3xlarge" class="block mb-2" />

  <div class="grid grid-cols-2 gap-4">
      <p class="text-gray-400">Subtotal</p>
      <p class="text-right">{{ cart()?.total | currency }}</p>

      <p class="text-gray-400">Discount ({{ (cart()?.discountPercentage ? (cart()?.discountPercentage ?? 0) / 100 : 0) | percent }})</p>
      <p class="text-right text-red-500">{{ cart()?.discount ?? 0 | currency }}</p>

      <p class="text-gray-400">Shipping</p>
      <p class="text-right">{{ cart()?.shipping | currency }}</p>
  </div>

  <div class="flex justify-between mt-2 pt-2 border-t-[1px] border-solid border-b-0 border-x-0 border-y-0">
    <p class="text-xl">Total</p>
    <p class="text-xl text-right">{{ ((cart()?.total ?? 0) - (cart()?.discount ?? 0)) + (cart()?.shipping ?? 0) | currency }}</p>
  </div>

  <ng-button label="Go to checkout" [filled]="true" [full]="true" class="mt-4" (click)="goToCheckout()" />
</div>

